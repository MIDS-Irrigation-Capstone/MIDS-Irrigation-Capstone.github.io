<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Exploratory Analysis | SimCLR-S2</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Exploratory Data Analysis of BigEarthNet-S2 data"><meta name=generator content="Hugo 0.81.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/ananke/dist/main.css_5c99d70a7725bacd4c701e995b969fea.css><link rel=stylesheet href=/css/main.css><meta property="og:title" content="Exploratory Analysis"><meta property="og:description" content="Exploratory Data Analysis of BigEarthNet-S2 data"><meta property="og:type" content="article"><meta property="og:url" content="https://mids-irrigation-capstone.github.io/data/eda/"><meta property="article:section" content="data"><meta itemprop=name content="Exploratory Analysis"><meta itemprop=description content="Exploratory Data Analysis of BigEarthNet-S2 data"><meta itemprop=wordCount content="1530"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Exploratory Analysis"><meta name=twitter:description content="Exploratory Data Analysis of BigEarthNet-S2 data"></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://mids-irrigation-capstone.github.io/images/sentinel2_france_1920.jpg)><div class="pb3-m pb6-l bg-black-60 article-header"><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib site-title">SimCLR-S2</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/data/ title="Data page">Data</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/models/ title="Models page">Models</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/results/ title="Results page">Results</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/team/ title="Team page">Team</a></li></ul><a href=https://github.com/MIDS-Irrigation-Capstone/Spring2021 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Exploratory Analysis</h1><h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">Exploratory Data Analysis of BigEarthNet-S2 data</h2></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">DATA</aside><h1 class="f1 athelas mt3 mb1">Exploratory Analysis</h1><div class="pa3 toc nested-links w-90"><p class="f5 b mb3">Contents</p><nav id=TableOfContents><ul><li><a href=#vegetation-and-water-canopy-indices>Vegetation and Water Canopy Indices</a><ul><li><a href=#enhanced-vegetation-index-evi>Enhanced vegetation Index (EVI)</a></li><li><a href=#soil-adjusted-vegetation-index-savi>Soil Adjusted Vegetation Index (SAVI)</a></li><li><a href=#moisture-stress-index-msi>Moisture Stress Index (MSI)</a></li><li><a href=#normalized-difference-infrared-index-ndii>Normalized Difference Infrared Index (NDII)</a></li><li><a href=#normalized-multi-band-drought-index-nmdi>Normalized Multi-band Drought Index (NMDI)</a></li></ul></li><li><a href=#image-pre-processing>Image Pre-processing</a></li><li><a href=#image-augmentation>Image Augmentation</a><ul><li><a href=#brightness>Brightness</a></li><li><a href=#contrast>Contrast</a></li><li><a href=#gamma-or-gain>Gamma or Gain</a></li></ul></li></ul></nav></div></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-90"><p>We perform an exploratory analysis on our data to get better insights into understanding the distributions for irrigated land in our labeled data set and identifying potential features that might enhance our ability to distinguish between permanently irrigated land from those that are not. We also explore pre-processing techniques that will help our models learn better from the data and analyze image augmentations that are more suited to satellite images in the context of irrigation detection</p><p>The BigEarthNet-S2 data set covers images from ten European countries: Austria, Belgium, Finland, Ireland, Kosovo, Lithuania, Luxembourg, Portugal, Serbia, Switzerland. These images are annotated with multiple labels. Cultivated land under agricultural use that are either permanently or periodically irrigated, using a permanent infrastructure like irrigation channels, drainage network, spray sprinkler line, rotary sprinkler and additional irrigation facilities are labeled with <a href=https://land.copernicus.eu/user-corner/technical-library/corine-land-cover-nomenclature-guidelines/html/index-clc-212.html><em>Permanently irrigated land</em></a>. Most of these crops cannot be cultivated without artificial water supply. And these labels do not include sporadically irrigated land. This label is our target label. Only 2.3% of the images in our data are labeled as <em>Permanently irrigated land</em>.</p><figure><img src=/images/LabelsCount.png alt="Figure 1: Distribution of labels in BigEarthNet-S2"><figcaption><p><strong>Figure 1:</strong> <em>Distribution of labels in BigEarthNet-S2</em></p></figcaption></figure><p>Further reading on the Corine land cover nomenclature showed that there were permanent crops which also potentially included permanently irrigated land and hop plantations but were covered under a different class label. These include <a href=https://land.copernicus.eu/user-corner/technical-library/corine-land-cover-nomenclature-guidelines/html/index-clc-221.html><em>Vineyards</em></a>, <a href=https://land.copernicus.eu/user-corner/technical-library/corine-land-cover-nomenclature-guidelines/html/index-clc-222.html><em>Fruit trees and berry plantations</em></a>, <a href=https://land.copernicus.eu/user-corner/technical-library/corine-land-cover-nomenclature-guidelines/html/index-clc-223.html><em>Olive groves</em></a> and <a href=https://land.copernicus.eu/user-corner/technical-library/corine-land-cover-nomenclature-guidelines/html/index-clc-213.html><em>Rice fields</em></a></p><figure><img src=/images/rice.png alt="Figure 2: Rice fields with the irrigation channels between parcels"><figcaption><p><strong>Figure 2:</strong> <em>Rice fields with the irrigation channels between parcels</em></p></figcaption></figure><p>Clubbing these above land classes with permanently irrigated land puts the percentage of potentially irrigated land at 6.2%. In our experiments, we compare and contrast our learnings from the pure target labels with those from the extended target labels to see if the latter helps generalize our models better.</p><figure><img src=/images/irr_stats.png alt="Figure 3: Statistics of irrigated land with additional labels"><figcaption><p><strong>Figure 3:</strong> <em>Statistics of irrigated land with additional labels</em></p></figcaption></figure><h2 id=vegetation-and-water-canopy-indices>Vegetation and Water Canopy Indices</h2><p>Remote sensors aboard satellites measure wavelengths of light absorbed and reflected by land surfaces. Pigments like chlorophyll, found in plant leaves, strongly absorb wavelengths of visible red light and strongly reflect wavelengths of near-infrared light. As plant canopy changes with seasons, these reflectance properties also change. Vegetation index is a transformation of two or more spectral bands designed to serve as an indication of health of vegetation for each pixel in a satellite image. There are several vegetation indices, of which, we studied a handful during our EDA.</p><h3 id=enhanced-vegetation-index-evi>Enhanced vegetation Index (EVI)</h3><p>EVI is an optimized vegetation index designed to enhance the vegetation signal with improved sensitivity in high biomass regions. A de-coupling of the canopy background signal and a reduction in atmosphere influences gives an improved vegetation monitoring. Typically EVI uses three bands: the red, blue and near infra-red. However, the blue band has often found to be problematic, with a poor signal to noise ratio. This is mainly due to the nature of the reflected energy in this part of the spectrum over land, which is extremely low. EVI is therefore computed using two bands following this equation:</p><p>$$ EVI= \frac{2.5 \times (NIR−Red)}{NIR+ (2.4 \times Red) +1} $$</p><figure><img src=/images/evi-beda.png alt="Figure 4: Visual bands (top) and EVI (bottom) for irrigated samples from BigEarthNet data"><figcaption><p><strong>Figure 4:</strong> <em>Visual bands (top) and EVI (bottom) for irrigated samples from BigEarthNet data</em></p></figcaption></figure><h3 id=soil-adjusted-vegetation-index-savi>Soil Adjusted Vegetation Index (SAVI)</h3><p>Normalized Differential Vegetative Index (NDVI) is sensitive to the effects of soil and atmosphere. SAVI is an adjusted form of widely used NDVI, developed to minimize the influence of soil brightness on spectral vegetation indices, particularly in areas of high soil composition. A soil adjustment factor <em>L</em> is added to the equation of <em>NDVI</em> to correct for soil noise effect like soil color, soil moisture etc.</p><p>$$ SAVI = \frac{(NIR – Red)}{(NIR + Red + L)} \cdot (1 + L) $$</p><p>L is a variable in $(-1, 1)$ and its value depends on the amount of green vegetation present in the area.</p><figure><img src=/images/savi-beda.png alt="Figure 5: SAVI for irrigated samples from BigEarthNet data"><figcaption><p><strong>Figure 5:</strong> <em>SAVI for irrigated samples from BigEarthNet data</em></p></figcaption></figure><h3 id=moisture-stress-index-msi>Moisture Stress Index (MSI)</h3><p>The Mositure Stress Index (MSI) is a reflectance measurement that is sensitive to the increasing leaf water content. As the water content of leaves in vegetation canopies increases, the strength of the absorption around 1600 nm (SWIR or band 11) increases. Absorption at 819 nm (NIR or band 8) is nearly unaffected by changing water content, so it is used as the reference. The MSI is inverted relative to the other water vegetative indices; higher values indicate greater water stress and less water content.</p><p>$$ MSI = \frac{MIR}{NIR} $$</p><h3 id=normalized-difference-infrared-index-ndii>Normalized Difference Infrared Index (NDII)</h3><p>NDII is a reflectance measurement that is sensitive to changes in water content of plant canopies. The NDII uses a normalized difference formulation instead of a simple ratio as used in MSI. The index values increase with increasing water content. Applications include crop agricultural management, forest canopy monitoring, and vegetation stress detection. The formula for computing thsi index is shown below:</p><p>$$ NDII=\frac{(NIR−MIR)}{(NIR+MIR)} $$</p><figure><img src=/images/ndii-beda.png alt="Figure 6: NDII for irrigated samples from BigEarthNet data"><figcaption><p><strong>Figure 6:</strong> <em>NDII for irrigated samples from BigEarthNet data</em></p></figcaption></figure><h3 id=normalized-multi-band-drought-index-nmdi>Normalized Multi-band Drought Index (NMDI)</h3><p>This index, also sometime referred to as Normalized Difference Water Index or NDWI, takes into account a soil moisture background to monitor potential drought conditions. Three specific bands were chosen because of their unique response to variations in soil and vegetation moisture. The index uses the difference between two liquid-water absorption bands in the shortwave-infrared region (1640 and 2130 nm) as a measure of water sensitivity in vegetation and soil. As soil moisture increases, the index values decrease. Index values range from 0.7 to 1 for dry soil, 0.6 to 0.7 for soil with intermediate moisture, and less than 0.6 for wet soil.</p><p>$$ NMDI=\frac{(NIR−(SWIR1−SWIR2))}{(NIR+(SWIR1−SWIR2))} $$</p><figure><img src=/images/nmdi-beda.png alt="Figure 7: NMDI for irrigated samples from BigEarthNet data"><figcaption><p><strong>Figure 7:</strong> <em>NMDI for irrigated samples from BigEarthNet data</em></p></figcaption></figure><p>These vegetation and water canopy indices are often highly correlated with one another, as evidenced in many of our image samples, a couple of which are shown below.</p><figure><img src=/images/cor-mat.png alt="Figure 8: Correlation matrix of vegetation and water canopy indices"><figcaption><p><strong>Figure 8:</strong> <em>Correlation matrix of vegetation and water canopy indices</em></p></figcaption></figure><h2 id=image-pre-processing>Image Pre-processing</h2><p>We observe that standardizing images increases the ability to distinguish features that are typically closer together. The below images and histograms are an attempt to visualize what this process does to image readability by adjusting the levels of the image pixels. In this example, we have standardized the pixels by computing the mean and standard deviation of a specific band 8 image from BigEarthNet-S2 dataset: <code>S2A_MSIL2A_20170613T101031_29_89_B08.tif</code>. The pre-processing improves the readability, as evidenced by the image and its histogram, on the right.</p><figure><img src=/images/eda1.png alt="Figure 9: Effect of standardizing images on a band 8 image. Original image (left), Standardized Image (right)"><figcaption><p><strong>Figure 9:</strong> <em>Effect of standardizing images on a band 8 image. Original image (left), Standardized Image (right)</em></p></figcaption></figure><p>For our experiments, however, we used the mean and the standard deviation computed for each band, by dataset, to scale down the scores to a common range. While we calculated the mean and the standard deviations for images that formed our California dataset, we used the provided statistics for BigEarthNet-S2.</p><h2 id=image-augmentation>Image Augmentation</h2><p>Image augmentation is a salient feature of the SimCLR pretrain step, where every raw image in a batch is subject to two transformations before we compute the similarity between these transformed images in the batch. During the exploratory analysis, we experimented with 9 different augmentation techniques to determine which ones would be most effective on Sentinel-2 images, given that we have 10 channels per image. We studied the following augmentations: rotate, flip, zoom, shift, blur, brightness, gain, contrast and speckle. The effect of some of these per pixel transformations are discussed below.</p><h3 id=brightness>Brightness</h3><p>The brightness of an image can be augmented either darkening or brightening the images, or both. This type of transformation allows a model to generalize across images trained on different lighting levels. Brightness is an additive operation and shifts the image pixel values to the left or right.</p><figure><img src=/images/aug-brightness.png alt="Figure 10: Histogram showing effects of brightness adjustment causing the scale to shift to the right in this example"><figcaption><p><strong>Figure 10:</strong> <em>Histogram showing effects of brightness adjustment causing the scale to shift to the right in this example</em></p></figcaption></figure><h3 id=contrast>Contrast</h3><p>Contrast is adjusted independently for each channel of the image. For a contrast factor $cf$, this operation computes the mean of the image pixels in the channel and then adjusts each component x of each pixel to $(x - mean) * cf + mean$.
Contrast adjustment analyzes the distribution of pixel densities in an image and then rescales the image to include all intensities that fall within a given range of intensities. For e.g. the 5th and 95th percentiles, as evidenced in image below.</p><figure><img src=/images/aug-contrast.png alt="Figure 11: Histogram showing effects of contrast adjustment, with factor 0.5, causing the counts to move closer to the mean."><figcaption><p><strong>Figure 11:</strong> <em>Histogram showing effects of contrast adjustment, with factor 0.5, causing the counts to move closer to the mean.</em></p></figcaption></figure><h3 id=gamma-or-gain>Gamma or Gain</h3><p>Every pixel in an image has a brightness level called luminance. This value ranges between 0 and 1 where 0 indicates complete darkness and 1 indicates fully bright. Different sensors and video devices capture luminance differently and therefore a correction is applied using the formula $Out = gain * In**gamma$ where $In$ is the original pixel value, $Out$ is the output pixel value and $gamma$ is correction factor and $gain$ is a scalar multiplier. Gamma operation is not symmetric about the mean as evidenced in the <em>figure 12</em> below</p><figure><img src=/images/aug-gamma.png alt="Figure 12: Effects of gamma adjustment causing the mean to shift to the left in this example"><figcaption><p><strong>Figure 12:</strong> <em>Effects of gamma adjustment causing the mean to shift to the left in this example</em></p></figcaption></figure><p>Gamma factor less than 1 causes an image to be darker while a value greater than 1 causes an image to be brighter, as demonstrated by the images below.</p><figure><img src=/images/gamma_eg.png alt="Figure 12: Effects of gamma factor on brightness of an image"><figcaption><p><strong>Figure 12:</strong> <em>Effects of gamma factor on brightness of an image</em></p></figcaption></figure><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$']],processEscapes:!0,processEnvironments:!0,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var b=MathJax.Hub.getAllJax(),a;for(a=0;a<b.length;a+=1)b[a].SourceElement().parentNode.className+=' has-jax'}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script></body></html>